App As appinfo:
    BackEnabled: =false
    OnMessage: =
    OnStart: |+
        =Set(varLogID, Param("LogID")); 
        
        ClearCollect(colSelectedMaintenanceLog, LookUp('Maintenance logs', MaintenanceLogs = GUID(varLogID)))
        ;
        //user language
        Set(
            gblUserLanguage,
            Switch(
                Left(
                    Language(),
                    2
                ),
                "en",
                "en-US",
                "fr",
                "fr-FR",
                "en-US"//default
            )
        );
        //build localization collection, with user's language
        ClearCollect(
            colLocalization,
            Filter(
                localizationDesktopApp,
                LanguageTag = gblUserLanguage
            )
        );
        
        Set(varCTCLogoRed, RGBA(237,38,38,1))
        ;
        Set(varCTCLogoGreen, RGBA(23,167,74,1))
        ;
        Set(varCTCLightGreen01, RGBA(217,246,224,1))
        ;
        Set(varCTCDarkGrey, RGBA(51,51,51,1))
        ;
        Set(varCTCLightGrey, RGBA(242,242,242,1))
        ;
        Set(varCTCBlueGrey, RGBA(159,188,206,1))
        ;
        ClearCollect(
                colNav,
                //Table(
                    {
                        Title: With({varDefault:"Edit Logs and Reports",varOOBTextId:"componentTextEditLogsReports"},With({varLocalizedText:LookUp(colLocalization,OOBTextID=varOOBTextId,LocalizedText)},Coalesce(varLocalizedText,varDefault))),
                        Screen: EditLogsReportsScreen,
                        Media: ImageReports2,
                        URL: Blank()
                    },
                    {
                        Title: With({varDefault:"Schedule Manager",varOOBTextId:"componentTextScheduleManager"},With({varLocalizedText:LookUp(colLocalization,OOBTextID=varOOBTextId,LocalizedText)},Coalesce(varLocalizedText,varDefault))),
                        Screen: ScheduleManagerScreen,
                        Media: ImageSchedule2,
                        URL: Blank()
                    },
                    {
                        Title: With({varDefault:"Maintenance Manual",varOOBTextId:"componentTextStoreMaintenanceManual"},With({varLocalizedText:LookUp(colLocalization,OOBTextID=varOOBTextId,LocalizedText)},Coalesce(varLocalizedText,varDefault))),
                        Screen: StoreMaintenanceManualScreen,
                        Media: ImageManual2,
                        URL: Blank()
                    },
                    {
                        Title: With({varDefault:"Protocols",varOOBTextId:"componentTextProtocols"},With({varLocalizedText:LookUp(colLocalization,OOBTextID=varOOBTextId,LocalizedText)},Coalesce(varLocalizedText,varDefault))),
                        Screen: ProtocolsScreen,
                        Media: ImageProtocol2,
                        URL: Blank()
                    }
                                )//)
        
        ;
        
        Set(Colors, {
            Primary1: RGBA(23,167,74,1),  // default (56, 96, 178, 1)
            Primary2: RGBA(237, 32, 48, 1),    // d (0, 18, 107, 1)
            Primary3: RGBA(245, 245, 245, 1),  // d (186, 202, 226, 1)
            TextMain: RGBA(0, 0, 0, 1),     // d (0, 0, 0, 1)
            TextLink: RGBA(0, 134, 208, 1),    // d (0, 134, 208, 1)
            Black: RGBA(0, 0, 0, 1),           // d (0, 0, 0, 1)
            Gray: RGBA(208, 212, 219, 1),      // d (166, 166, 166, 1)
            LightGray: RGBA(235, 237, 239, 1), // d (244, 244, 244, 1)
            White: RGBA(255, 255, 255, 1)      // d (255, 255, 255, 1)
        
        }
        );
        //Set(gblUserLanguage, "en-US" );
        //build localization collection, with user's language
        //ClearCollect(colLocalization, Filter(localizationDesktopApp, LanguageTag = gblUserLanguage));
        
        If(IsBlank(varLogID) <> true,
        
        ClearCollect(colWeekNumber,
        
        {Value: If(
            Len(
                Text(
                    RoundDown(
                        (RoundUp(
                            First(colSelectedMaintenanceLog).NextScheduledLogDate - Date(
                                Year(First(colSelectedMaintenanceLog).NextScheduledLogDate - Weekday(First(colSelectedMaintenanceLog).NextScheduledLogDate - 1) + 4),
                                1,
                                3
                            ),
                            0
                        ) + Weekday(
                            Date(
                                Year(First(colSelectedMaintenanceLog).NextScheduledLogDate - Weekday(First(colSelectedMaintenanceLog).NextScheduledLogDate - 1) + 4),
                                1,
                                3
                            )
                        ) + 5) / 7,
                        0
                    )
                )
            ) = 1,
            "0" & RoundDown(
                (RoundUp(
                    First(colSelectedMaintenanceLog).NextScheduledLogDate - Date(
                        Year(First(colSelectedMaintenanceLog).NextScheduledLogDate - Weekday(First(colSelectedMaintenanceLog).NextScheduledLogDate - 1) + 4),
                        1,
                        3
                    ),
                    0
                ) + Weekday(
                    Date(
                        Year(First(colSelectedMaintenanceLog).NextScheduledLogDate - Weekday(First(colSelectedMaintenanceLog).NextScheduledLogDate - 1) + 4),
                        1,
                        3
                    )
                ) + 5) / 7,
                0
            ),
            RoundDown(
                (RoundUp(
                    First(colSelectedMaintenanceLog).NextScheduledLogDate - Date(
                        Year(First(colSelectedMaintenanceLog).NextScheduledLogDate - Weekday(First(colSelectedMaintenanceLog).NextScheduledLogDate - 1) + 4),
                        1,
                        3
                    ),
                    0
                ) + Weekday(
                    Date(
                        Year(First(colSelectedMaintenanceLog).NextScheduledLogDate - Weekday(First(colSelectedMaintenanceLog).NextScheduledLogDate - 1) + 4),
                        1,
                        3
                    )
                ) + 5) / 7,
                0
            )
        )})
        
        
        ;
        
        Navigate(EditLogsReportsScreen,ScreenTransition.None,
        
        {LvarDetail01: First(colSelectedMaintenanceLog).Detail01Completed,
        LvarDetail02: First(colSelectedMaintenanceLog).Detail02Completed,
        LvarDetail03: First(colSelectedMaintenanceLog).Detail03Completed,
        LvarDetail04: First(colSelectedMaintenanceLog).Detail04Completed,
        LvarDetail05: First(colSelectedMaintenanceLog).Detail05Completed,
        LvarDetail06: First(colSelectedMaintenanceLog).Detail06Completed,
        LvarDetail07: First(colSelectedMaintenanceLog).Detail07Completed,
        LvarDetail08: First(colSelectedMaintenanceLog).Detail08Completed,
        LvarDetail09: First(colSelectedMaintenanceLog).Detail09Completed,
        LvarDetail10: First(colSelectedMaintenanceLog).Detail10Completed,
        LvarFollowUpRequired: First(colSelectedMaintenanceLog).FollowUpRequired, LvarFollowUpRequiredFrench: First(colSelectedMaintenanceLog).FollowUpRequiredFrench,
        LvarViewIndividualLog: true})
        
        , Navigate(EditLogsReportsScreen))
        
        
        
        
        
        
        
        
        
        
        
        
        

